<!-- HTML header for doxygen 1.8.17-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>AirControl: Aircontrol Camera API</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only.css" rel="stylesheet" type="text/css"/>
<link href="doxygen-awesome-sidebar-only-darkmode-toggle.css" rel="stylesheet" type="text/css"/>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-5CGYFWBL33"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-5CGYFWBL33');
</script>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo_55.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">AirControl
   &#160;<span id="projectnumber">0.0.5</span>
   </div>
   <div id="projectbrief">Open Source, Modular, and Extensible Flight Simulator For Deep Learning Research</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('md_readmes_camera_example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Aircontrol Camera API </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md12"></a>
Camera Placement</h1>
<p><a class="el" href="namespaceAirControl.html">AirControl</a> Airplane has two cameras. One is in the Cockpit and another is a follow camera. Both the camera can be used for capturing screenshots while in flight.</p>
<h1><a class="anchor" id="autotoc_md13"></a>
Python API</h1>
<p>Python API has a <code>set_camera</code> function to set the camera properties. <code>set_camera</code> function takes the following arguments:</p><ul>
<li>InputControlType (str, optional): It can be either <code>Code</code> or <code>Other</code>. This is to control the internal mechanism and prevent repeated calling in already set variables. \ If <code>InputControlType</code> is set to 'Code', the camera cannot be controlled from Keyboard or Joystick. If <code>InputControlType</code> is set to 'Other', the camera can be only controlled from Keyboard or Joystick. Defaults to "Code".</li>
<li>ActiveCamera (int, optional): Aircontrol Airplane has two cameras inside the Cockpit and outside the Airplane. The Camera inside the Cockpit is indexed as 0. The outside of the Airplane is indexed as 1. <code>ActiveCamera</code> can be used to select the scene camera. Defaults to 1.</li>
<li>IsCapture (bool, optional): <code>Iscapture</code> if true the screenshot will be captured. Defaults to False.</li>
<li>CaptureCamera (int, optional): <code>CaptureCamera</code> defines which camera should be used for capturing the scene. Defaults to 1.</li>
<li>CaptureType (int, optional): Choose between different capture types. Defaults to 1.</li>
<li>CaptureWidth (int, optional): Width of the captured image. Defaults to 256.</li>
<li>CaptureHeight (int, optional): Height of the captured image. Defaults to 256.</li>
<li>IsOutput (bool, optional): By default <code>set_camera</code> function only sets the internal state. <code>set_camera</code> only provides log output and not the actual captured image. <code>set_control</code> when called it returns the actual output. IF you want to force <code>set_camera</code> to return the image, set <code>IsOutput</code> to True. Defaults to False.</li>
</ul>
<p><b>Capture Types</b></p>
<p>One of the main challenges in Machine Learning is the task of getting large amounts of training data in the right format. Deep learning, and machine learning more generally, needs huge training sets to work properly. Virtual worlds can provide a wealth of training data. However, it must consist of more than just the final image: object categorization, optical flow, etc</p>
<p><code>Capture Types</code> can be set to the following:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Capture Type </th><th class="markdownTableHeadNone">Type </th><th class="markdownTableHeadNone">Details  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone">Scene Capture </td><td class="markdownTableBodyNone">Capture from scene Camera  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">Instance Segmentation </td><td class="markdownTableBodyNone">Each object in the scene gets unique color  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2 </td><td class="markdownTableBodyNone">Semantic segmentation </td><td class="markdownTableBodyNone">Objects are assigned color based on their category  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3 </td><td class="markdownTableBodyNone">Depth </td><td class="markdownTableBodyNone">Pixels are colored according to their motion in the relation to the camera  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">Normals </td><td class="markdownTableBodyNone">Surfaces are colored according to their orientation in relation to the camera  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">5 </td><td class="markdownTableBodyNone">Optical Flow </td><td class="markdownTableBodyNone">Pixels are colored according to their distance from the camera (Only visible when Airplane or Object in reference are moving)  </td></tr>
</table>
<h1><a class="anchor" id="autotoc_md14"></a>
Implementation details</h1>
<p>First of all <code>AC_Airplane_CameraController.OnSceneChange()</code> calls ColorEncoding class to encode unique object idenitifier and layer as RGB color. These colors are stored in MaterialPropertyBlock for each object and are automatically passed into the shaders when rendering.</p>
<p>Upon start <code>AC_Airplane_CameraController</code> component creates hidden camera for every single pass of output data (image segmentation, optical flow, depth, etc). These cameras allow to override usual rendering of the scene and instead use custom shaders to generate the output. These cameras are attached to different scene camera using <code>Camera.targetDisplay property</code> - handy for preview in the Editor.</p>
<p>For Image segmentation and Object categorization pass special replacement shader is set with `Camera.SetReplacementShader(). It overrides shaders that would be otherwise used for rendering and instead outputs encoded object id or layer.</p>
<p>Optical flow and Depth pass cameras request additional data to be rendered with <code>DepthTextureMode.Depth</code> and <code>DepthTextureMode.MotionVectors</code> flags. Rendering of these cameras is followed by drawing full screen quad <code>CommandBuffer.Blit()</code> with custom shaders that convert 24/16bit-per-channel data into the 8-bit RGB encoding.</p>
<h1><a class="anchor" id="autotoc_md15"></a>
Importing Requirements</h1>
<div class="fragment"><div class="line">from AirControl.communicator import Communicator</div>
<div class="line">from AirControl import schemaDef</div>
<div class="line">from pprint import pprint</div>
<div class="line">import PIL.Image as Image</div>
<div class="line">import base64</div>
<div class="line">import numpy as np</div>
<div class="line">from io import BytesIO</div>
<div class="line">from matplotlib.pyplot import  imshow</div>
<div class="line">import matplotlib.pyplot as plt</div>
<div class="line"> </div>
<div class="line">connection = Communicator()</div>
</div><!-- fragment --><h1><a class="anchor" id="autotoc_md16"></a>
Examples (Cockpit Camera)</h1>
<p><b>Scene Capture</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=0,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_7_0.png" alt="png" class="inline"/></p>
<p><b>Instance Segmentation</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=1,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_9_0.png" alt="png" class="inline"/></p>
<p><b>Semantic segmentation</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=2,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_11_0.png" alt="png" class="inline"/></p>
<p><b>Depth</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=3,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_13_0.png" alt="png" class="inline"/></p>
<p><b>Normals</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=4,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_15_0.png" alt="png" class="inline"/></p>
<p><b>Optical Flow</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=0,CaptureType=5,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_17_0.png" alt="png" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md17"></a>
Example (External Camera)</h1>
<p><b>Scene Capture</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=0,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_7_0.png" alt="png" class="inline"/></p>
<p><b>Instance Segmentation</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=1,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_22_0.png" alt="png" class="inline"/></p>
<p><b>Semantic segmentation</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=2,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_24_0.png" alt="png" class="inline"/></p>
<p><b>Depth</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=3,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_26_0.png" alt="png" class="inline"/></p>
<p><b>Normals</b></p>
<div class="fragment"><div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=4,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_28_0.png" alt="png" class="inline"/></p>
<p><b>Optical Flow</b></p>
<div class="fragment"><div class="line">## no movement no optcal flow</div>
<div class="line">camera_schema = schemaDef.set_camera(ActiveCamera=1, IsCapture=True,CaptureCamera=1,CaptureType=5,CaptureHeight=256,CaptureWidth=256,IsOutput=True)</div>
<div class="line">connection.send_data(camera_schema)</div>
<div class="line">output =  connection.receive_data()</div>
<div class="line">image = output[&#39;ScreenCapture&#39;]</div>
<div class="line">if image != &quot;&quot;:</div>
<div class="line">    im = Image.open(BytesIO(base64.b64decode(image)))</div>
<div class="line">    imshow(np.asarray(im))</div>
<div class="line">    plt.axis(&#39;off&#39;)</div>
</div><!-- fragment --><p><img src="../images/camera_example_files/camera_example_30_0.png" alt="png" class="inline"/></p>
<h1><a class="anchor" id="autotoc_md18"></a>
Reference</h1>
<ol type="1">
<li><a href="https://docs.unity3d.com/Manual/SL-ShaderReplacement.html">Replacement Shaders</a></li>
<li><a href="https://docs.unity3d.com/Manual/GraphicsCommandBuffers.html">Command Buffers</a></li>
<li><a href="https://docs.unity3d.com/Manual/SL-CameraDepthTexture.html">Depth and Motion Vectors</a></li>
<li><a href="https://docs.unity3d.com/ScriptReference/MaterialPropertyBlock.html">MaterialPropertyBlock</a> </li>
</ol>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.17-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
